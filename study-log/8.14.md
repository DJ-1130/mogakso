📘 LSTM 기반 메뉴별 매출 예측 파라미터 개선 기록
1. 목표

SMAPE 점수 낮추기 (Public 기준 0.70 컷을 안정적으로 통과 → 최종 0.6725 달성)

Public ↔ Private 점수 격차 최소화 (오버피팅 방지 및 일반화 성능 확보)

특정 업장 과대예측 완화 (담하, 미라시아 같은 패턴 강한 레스토랑)

2. 개선한 파라미터 및 기법
2.1 시드 고정 (seed=42)

이유: 재현성 확보. 매 실행마다 결과가 달라지면 튜닝 효과 검증이 불가능.

효과: 결과 변동성을 줄여 실험 비교가 명확해짐.

2.2 업장별 블렌딩 가중치 (α 조정)

기존: alpha = 0.5 (LSTM 50%, 중앙값 50%)

개선:

담하 → 0.55 (중앙값 비중 ↑)

미라시아 → 0.60 (중앙값 비중 ↑)

이유: LSTM이 과대 튀는 업장에선 중앙값(안정적 추정치) 비중을 높여 변동성 완화.

효과: 과대예측 줄여 SMAPE 개선(약 0.005~0.01).

2.3 상한 캡 스케일링 (cap_scale)

기존: cap_scale=1.2

개선: cap_scale=1.1, 담하는 1.05

이유: 최근 28일 매출 대비 과대 꼬리 자르기.

효과: 폭발적 과대값 제거 → 안정화 + 점수 개선.

2.4 ε-floor (하한값) 동적 적용

기존: 모든 구간 eps=1.0

개선: 최근 28일 제로율 ≥ 60% → eps=0.5, 그 외는 1.0

이유: 간헐적 수요 메뉴에 불필요한 최소 매출값 생성 방지.

효과: 제로 위주 메뉴에서 과대 방지.

2.5 중앙값 → 분위수 (Quantile) 보정

기존: 요일별 중앙값(50%)

개선: 요일별 60% 분위수(q=0.6)

이유: 중앙값은 지나치게 보수적 → 약간 상향으로 과소예측 보정.

효과: 안정적이면서도 소폭 공격적 예측 → 점수 소폭 개선(0.002~).

2.6 모델 학습 파라미터

기존: EPOCHS=40, hidden_dim=64, dropout=0.1

개선: EPOCHS=50, hidden_dim=96, dropout=0.2 (GPU 환경)

이유: 학습 용량을 늘려 복잡한 패턴 학습.

효과: 미세 개선 + 과적합 방지 (CV 확인 필요).

3. 현재 성과

Public Score: 0.6726 (컷 0.70 이하 달성)

개선 효과:

업장별 튀는 패턴 완화

과대예측 꼬리 제거

제로율 높은 메뉴 안정화

전반적으로 Public/Private 안정성 ↑

4. 앞으로의 목표

Cross Validation 추가

28→7 슬라이딩 윈도우로 롤링 CV 검증 → Public/Private 격차 최소화.

Feature 추가 실험

주말/공휴일 플래그, moving average, rolling std.

Blending 강화

업장별 α/캡/ε-floor 조합을 더 정교하게 튜닝.

Ensemble 시도

단순 LSTM + LightGBM 블렌딩.
